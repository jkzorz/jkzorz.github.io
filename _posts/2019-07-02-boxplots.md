---
layout: post
title: "Boxplots"
date: 2019-07-02
---


Boxplots are a relatively simple way to show numerical data, while providing the viewer key infomration about the range, mean, and distribution of the data. I'm going to be creating boxplots to visualize the distributions of species that are statistically differentially abundant between groups. The statistics to determine the differentially abundant species was done using <b>indicator species analysis</b> which was explained in <b>[this tutorial](https://jkzorz.github.io/2019/07/02/Indicator-species-analysis.html)</b>.

First, we load in the data as before: 

```
pc = read.csv("Your_OTU_table.csv", header= TRUE)
```

This table has the format of rows as samples and columns as OTUs/species. 

![useful image]({{ site.url }}/assets/Wide_extra_variable_excel.png)

Next, we subset the data as desired by calling the specific columns we want to include in our boxplot figure. I've chosen the top four most significant OTUs associated with the "Late" grouping, identified using the [indicator species analysis test](https://jkzorz.github.io/2019/07/02/Indicator-species-analysis.html).

```
sub_pc = data.frame(Time = pc$Time, OTU15 = pc$OTU15, OTU11 = pc$OTU11, OTU26 = pc$OTU26, OTU6 = pc$OTU6) 
```

Next, we load in the ggplot2 and reshape2 packages (for plotting and data manipulation respectively): 

 ```
 library(ggplot2)
 library(reshape2)
 ```

Next, we convert the data frame from a "wide" format to a "long" format [(See here for example of wide vs long data)](https://jkzorz.github.io/2019/06/05/stacked-bar-plots.html): 

```
sub_pc_m = melt(sub_pc, id = "Time")
```

Now we can plot the data using <b>geom_boxplot</b> from ggplot2: 

```
gg = ggplot(sub_pc_m, aes(x = variable, y = value, fill = Time)) + 
   geom_boxplot(colour = "black") +     
   theme(legend.title = element_text(size = 12, face = "bold"),
   legend.text = element_text(size = 10, face = "bold"), legend.position = "right", 
   axis.text.x = element_text(face = "bold",colour = "black", size = 12), 
   axis.text.y = element_text(face = "bold", size = 12, colour = "black"), 
   axis.title.y = element_text(face = "bold", size = 14, colour = "black"),
   panel.background = element_blank(), panel.border = element_rect(fill = NA, colour = "black"), 
   legend.key=element_blank()) + 
   labs(x= "", y = "Relative Abundance (%)", fill = "Time") + 
  scale_fill_manual(values = c("steelblue2", "steelblue4"))

gg
```


Save using: 
```
ggsave("Boxplot.svg")
```

